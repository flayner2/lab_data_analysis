from Bio.Seq import Seq
from helpers import filter_seqs


def test_seq_not_changed():
    seq_without_x = Seq(
        (
            "TTTTTATAAGAATTGCAGTGTGATACGAAATACTAGAACATCATTTTATAATCCGTGTAATAAAAATTATAAT"
            "CTAGTATGTGTACTGCATTAGATCAATGGTTTTATATATATATCTATATAGTTTATCGTGCTTATTTAACGAA"
            "CGCTTTGTAAAAAAGTGTTTTTTTTTTTTGTATAAGCATTCACATTATTAAAAACATTATTATCAATTAATTT"
            "GAAAATTTTATTTCTATATTATATTATCGCAGGTATCGAGTATAATTACGCGAACACGATGCGGCATCTTTTT"
            "CAATATTATAAAATAATTATATATGTATAATAATTACCTATAATAGATTCAATAATAAATATTCATTTAAAAT"
            "ATCTCTTAAAAGAGTTTTTTCTTTACAGCGGTATATCTTTCCATATAGTTATCATAACCATCAAGATTAGCAA"
            "ATTGTTTTATCTCAAATAAATTTCCTTCAACAGACAGGACTGAAATTTTAGAATTTTTCAAAATTTTACTAGG"
            "TATTGCATTCAGTTGTAAACAATTTTCTTCAAGTCTTAATGT"
        )
    )

    assert filter_seqs.process_seq_by_class(seq_without_x, None) == seq_without_x


def test_class1_trimming():
    class_1 = Seq(
        (
            "ACTCTTTNCTCAGCTATGCXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
            "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXACTGGAATCGGA"
            "ATGCGCCGCACCAGGAGAAAAACCACGGTTCCTTGGTGTTCGCGAGCAGCGAGTAACGCATATTTTAATCTTT"
            "TTGATGATCGGTTGTTCGGTCCTACTCACACCAATGTTGAGACACATACCTATGCCGGTATTATTCGGCGTTT"
            "TTCTTTATATGGGAGTCGCTTCGTTGAAAGGACTTCAATTTTTCGACAGAATTTTAATTATGTTGATGCCGGT"
            "TAAATACCAACCCGATTATATGTTTCTTCGTCAGGTACCTCGGCCGCGACCACGCTXXXXXXXXXXXXXXXXX"
            "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
            "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXA"
        )
    )
    expected = Seq(
        (
            "ACTGGAATCGGAATGCGCCGCACCAGGAGAAAAACCACGGTTCCTTGGTGTTCGCGAGCAGCGAGTAACGCAT"
            "ATTTTAATCTTTTTGATGATCGGTTGTTCGGTCCTACTCACACCAATGTTGAGACACATACCTATGCCGGTAT"
            "TATTCGGCGTTTTTCTTTATATGGGAGTCGCTTCGTTGAAAGGACTTCAATTTTTCGACAGAATTTTAATTAT"
            "GTTGATGCCGGTTAAATACCAACCCGATTATATGTTTCTTCGTCAGGTACCTCGGCCGCGACCACGCT"
        )
    )

    assert filter_seqs.process_seq_by_class(class_1, 1) == expected


def test_class3_trimming():
    class_3 = Seq(
        (
            "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
            "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
            "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXACCTCCTATATATATATGTA"
            "TATATATATATATATATCAATGTGTAATACCGCTAGTTTTCTCTCGATTCGTTCGAAAATTGTGGCTCTTTCG"
            "GGCGAAACCGGCTGGGTCTGTGTGTACTCTCATCCTGTTTCGTGAACCGAAAGCTCCCTTTCTCCGAAGAAGA"
            "AGAATACATTTTTTTTTCGTGCGCGTAACACGCAACGGGCATTAAGTTACAAACGAAACGAGCTTTACCGCGT"
            "TCCTTCCCTTTAAGGGAGTCGCGGATGTTATACAAATGAAAAGAAAAAG"
        )
    )
    expected = Seq()


def test_class6_trimming():
    class_6 = Seq(
        (
            "GGGTTAGTTCAACGGAATCCCGGAAAGTAGCGAGTGTGAGACACGACGGTACCGCTCTATAAAATCATAAAGA"
            "GCGXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
            "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
            "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
            "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
            "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
            "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
            "XXXXXXXXXXXXXXXXXXXX"
        )
    )


def test_class7_trimming():
    class_7 = Seq(
        (
            "GTGCGTGCATGTGTGTGTGTGAGGGTACGTGAGGTATGTGTAACACAATATAGTATAAAATACTAATATTGTA"
            "CAAAATAAAGGATTAAAAATCAAAGCACAATTTATCATTTTATCAAATTGTATTGAGACTAATATACATGTAA"
            "AATATTTAAGTACAATATTGGTTATAAAACATGATATATTAATTAATTTGCTTTTATGTTTTAGGCATATTAT"
            "TTACTATTAATTAAAAGTATTAAGTTTGTTATAAATAATGATTAACGATACAGTAGCTTATTATAAATAAGAT"
            "GAAATAATTGAAATAATTTGTGTATCAAATAATTACTATATTATTAAAGTGTTGATATTATACTCGTTAAAAA"
            "AAAAAAAAATATCCAAAAAXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
            "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXTTT"
        )
    )
